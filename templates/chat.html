<nav class="navbar navbar-vertical fixed-left navbar-expand-md navbar-light bg-white" id="sidenav-main"><br>
    <ng-include src="'./side_nav.html'" ng-controller="SideNavCtrl"></ng-include>
</nav>

<div class="main-content">
    <!-- Navbar -->
    <nav class="navbar navbar-top navbar-expand-md navbar-dark" id="navbar-main">
        <div class="container-fluid">
            <!-- Brand -->
            <a class="h4 mb-0 text-white text-uppercase  " id="route_title">Chat Room</a>


            <form class="navbar-search navbar-search-dark form-inline mr-3 d-none d-md-flex ml-lg-auto">
                <div class="form-group mb-0">
                    <div class="input-group input-group-alternative">
                        <div class="input-group-prepend">
                            <span class="input-group-text"><i class="fas fa-search"></i></span>
                        </div>
                        <input class="form-control" placeholder="Search" type="text" ng-model="tableSearch">
                    </div>
                </div>
            </form>

            <!-- User -->
            <ul class="navbar-nav align-items-center d-none d-md-flex">
                <li class="nav-item dropdown">
                    <a class="nav-link pr-0" href="#" role="button" data-toggle="dropdown" aria-haspopup="true"
                        aria-expanded="false">
                        <div class="media align-items-center">

                            <span class="avatar avatar-sm rounded-circle" ng-if="profile_pic_true == null">
                                <span ng-if="user_info.gender == 'Male'">
                                    <img src="./assets/img/theme/m_profile_icon.jpg" class="rounded-circle">
                                </span>
                                <span ng-if="user_info.gender == 'Female'">
                                    <img src="./assets/img/theme/f_profile_icon.png" class="rounded-circle">
                                </span>
                                <!-- <img alt="Image placeholder" src="./assets/img/theme/team-4-800x800.jpg"> -->
                            </span>

                            <span class="avatar avatar-sm rounded-circle" ng-if="profile_pic_true != null">
                                <img alt="Image placeholder" ng-src="{{ profile_pic }}">
                            </span>


                            <div class="media-body ml-2 d-none d-lg-block">
                                <span
                                    class="mb-0 text-sm  font-weight-bold text-uppercase">{{user_info.username}}</span>
                            </div>
                        </div>
                    </a>
                    <div class="dropdown-menu dropdown-menu-arrow dropdown-menu-right">
                        <div class=" dropdown-header noti-title">
                            <h6 class="text-overflow m-0">Welcome {{user_info.username}}</h6>
                        </div>
                        <a href="profile" class="dropdown-item">
                            <i class="ni ni-single-02"></i>
                            <span>My profile</span>
                        </a>
                        <a class="dropdown-item">
                            <i class="ni ni-settings-gear-65"></i>
                            <span>Settings</span>
                        </a>
                        <a class="dropdown-item">
                            <i class="ni ni-calendar-grid-58"></i>
                            <span>Activity</span>
                        </a>
                        <a class="dropdown-item">
                            <i class="ni ni-support-16"></i>
                            <span>Support</span>
                        </a>
                        <div class="dropdown-divider"></div>
                        <a class="dropdown-item" ng-click="logout()">
                            <i class="ni ni-user-run"></i>
                            <span>Logout</span>
                        </a>
                    </div>
                </li>
            </ul>
        </div>
    </nav>
    <!-- End Navbar -->
    <!-- Header -->
    <div class="header bg-gradient-primary pb-5 pt-5 pt-md-8">
        <div class="container-fluid">
            <div class="header-body">

            </div>
        </div>
    </div>
    <div class="container-fluid mt--7">

        <!-- Table -->
        <div class="row" id="department_detail">



            <!-- <span class="h4 mb-0 text-white text-uppercase d-none d-lg-inline-block">( {{departments.length}} ) -
          Departments</span> -->
            <div class="card shadow col-md-12">
                <div class="row">
                    <div class="col-md-4">
                        <div id="users_list_in_department">
                            <legend></legend>
                            <div class="list-group" style="height: 500px;  overflow: auto;  scroll-behavior: smooth;"
                                id="style-1">

                                <a href="#" class="list-group-item list-group-item-action"
                                    ng-repeat="user in department_users | filter: tableSearch"
                                    ng-click="view_user(user)">
                                    <span class="row">

                                        <span class="col-md-2">
                                            <span class="avatar avatar-sm rounded-circle"
                                                ng-if="user.profile_pic == null">
                                                <span ng-if="user.gender == 'Male'">
                                                    <img src="./assets/img/theme/m_profile_icon.jpg"
                                                        class="rounded-circle">
                                                </span>
                                                <span ng-if="user.gender == 'Female'">
                                                    <img src="./assets/img/theme/f_profile_icon.png"
                                                        class="rounded-circle">
                                                </span>
                                                <!-- <img alt="Image placeholder" src="./assets/img/theme/team-4-800x800.jpg"> -->
                                            </span>

                                            <span class="avatar avatar-sm rounded-circle"
                                                ng-if="user.profile_pic != null">
                                                <img alt="Image placeholder"
                                                    ng-src="{{ users_prifile_path }}{{ user.profile_pic }}">
                                            </span>
                                        </span>

                                        <span class="col-md-10">
                                            <span class="">

                                                <span style="margin-left:7px;" class="text-primary">
                                                    {{ user.f_name }} {{ user.l_name }}

                                                    <span style="margin-left:7px;" class="badge badge-success"
                                                        ng-hide=" user.is_read_user_messages.is_read_count == '0'">
                                                        {{ user.is_read_user_messages.is_read_count }}
                                                    </span>

                                                </span> <br>
                                                <span style="margin-left:7px; font-size: smaller;" class="">
                                                    {{ user.email }}
                                                </span>



                                            </span>
                                        </span>
                                    </span>

                                </a>

                            </div>


                        </div>

                    </div>
                    <div class="col-md-8  bg-secondary">
                        <!-- <p>
              {{ department_user_info }}
            </p> -->
                        <div class="row">

                            <div class="col-md-5 mb-5 mb-xl-0 " ng-if="department_user_info != null">
                                <br><br><br>
                                <div class="card card-profile shadow ">
                                    <div class="row justify-content-center">
                                        <div class="col-lg-3 order-lg-2">
                                            <div class="card-profile-image">

                                                <a href="#">
                                                    <span class="" ng-if="department_user_info.profile_pic == null">
                                                        <span ng-if="department_user_info.gender == 'Male'">
                                                            <img src="./assets/img/theme/m_profile_icon.jpg"
                                                                class="rounded-circle">
                                                        </span>
                                                        <span ng-if="department_user_info.gender == 'Female'">
                                                            <img src="./assets/img/theme/f_profile_icon.png"
                                                                class="rounded-circle">
                                                        </span>
                                                        <!-- <img alt="Image placeholder" src="./assets/img/theme/team-4-800x800.jpg"> -->
                                                    </span>

                                                    <span class="" ng-if="department_user_info.profile_pic != null">
                                                        <img alt="Image placeholder"
                                                            ng-src="{{ users_prifile_path }}{{ department_user_info.profile_pic }}">
                                                    </span>

                                                </a>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="card-header text-center border-0 pt-8 pt-md-4 pb-0 pb-md-4">
                                        <div class="d-flex justify-content-between">
                                            <a href="#" class="btn btn-sm btn-info mr-4">Connect</a>
                                            <a href="#" class="btn btn-sm btn-default float-right">Message</a>
                                        </div>
                                    </div>
                                    <div class="card-body pt-0 pt-md-4">
                                        <br><br>
                                        <div class="text-center">
                                            <h3>
                                                {{ department_user_info.f_name }} {{ department_user_info.l_name }}
                                            </h3>


                                            <div class="h5 ">
                                                <i class="ni business_briefcase-24 mr-2"></i>
                                                {{ department_user_info.email }}
                                            </div>
                                            <div class="h5 font-weight-300 text-primary">
                                                <i class="ni location_pin mr-2"></i>
                                                {{ department_user_info.department }}
                                            </div>
                                            <h4>
                                                UNION GLOBAL SYSTEMS
                                            </h4>

                                            <div class="h5 font-weight-300 text-primary">
                                                <i class="ni location_pin mr-2"></i>{{ department_user_info.city }},
                                                {{ department_user_info.country }}
                                            </div>
                                            <hr class="my-4" />
                                            <div class="h5 ">
                                                <i class="ni business_briefcase-24 mr-2"></i>
                                                {{ department_user_info.bio }}
                                            </div>

                                            <!-- <a href="#">Show more</a> -->
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="col-md-7 " ng-if="department_user_info != null">

                                <div class="card " style="height: 470px;  overflow: auto;  scroll-behavior: smooth;"
                                    id="style-1">
                                    <div>
                                        <p>
                                            <p style="margin-left: 50px; margin-top: 200px;;" class="h1 text-primary"
                                                ng-if="private_chat == undefined">
                                                No message to Show
                                            </p>

                                            <p class="alert alert-secondary" role="alert"
                                                style="margin-left: 10px; margin-right: 10px; margin-bottom: 4px; padding: 4px; padding-right:4px; font-size: small;"
                                                ng-repeat="chat in private_chat" ng-if="private_chat">

                                                <span class="text-success" ng-if="chat.sender_id != user_info.user_id">
                                                    <strong>

                                                        <span>
                                                            {{chat.sender_name}}
                                                        </span>

                                                    </strong>
                                                    <span class="float-right">
                                                        {{chat.timestamp | date: medium}}
                                                    </span>
                                                    <legend style="margin: 0px;"></legend>




                                                    <span class="text-success">
                                                        {{chat.message}}
                                                    </span>

                                                </span>

                                                <span class="text-primary" ng-if="chat.sender_id == user_info.user_id">
                                                    <strong>
                                                        <span> Me</span>

                                                    </strong>
                                                    <span class="float-right">
                                                        {{chat.timestamp | date: medium}}
                                                    </span>
                                                    <legend style="margin: 0px;"></legend>


                                                    <span>
                                                        {{chat.message}}
                                                    </span>
                                                </span>


                                            </p>




                                        </p>
                                    </div>

                                </div>
                                <div class="input-group">


                                    <textarea name="" class="form-control" id="message_input"
                                        placeholder="Type here ..." aria-describedby="validationTooltipUsernamePrepend"
                                        required ng-model="message_">

                                    </textarea>
                                    <input type="hidden" id="reciever_id_" ng-model="reciever_id_">
                                    <div class="input-group-prepend" ng-click="sendMessage()">
                                        <span class="input-group-text" id="validationTooltipUsernamePrepend">
                                            <i class="ni ni-send text-primary"></i>
                                        </span>
                                    </div>

                                </div>



                            </div>

                        </div>


                    </div>

                </div>
            </div>



        </div>

    </div>
</div>

<script>
    $(function () {

    });
</script>